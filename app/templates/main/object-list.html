{% extends "main/layout.html" %}
{% set active_page = 'object-list' %}

{% block title %}Список объектов{% endblock %}

{% block content %}
<!--<div class="d-flex flex-column flex-md-row p-4 gap-4 py-md-5 align-items-center justify-content-center">-->
<!--    <div class="list-group"><a href="#" class="list-group-item list-group-item-action d-flex gap-3 py-3"-->
<!--                               aria-current="true"> <img src="https://github.com/twbs.png" alt="" width="32" height="32"-->
<!--                                                         class="rounded-circle flex-shrink-0">-->
<!--        <div class="d-flex gap-2 w-100 justify-content-between">-->
<!--            <div><h6 class="mb-0">List group item heading</h6>-->
<!--                <p class="mb-0 opacity-75">Some placeholder content in a paragraph.</p></div>-->
<!--            <small class="opacity-50 text-nowrap">now</small></div>-->
<!--    </a> <a href="#" class="list-group-item list-group-item-action d-flex gap-3 py-3" aria-current="true"> <img-->
<!--            src="https://github.com/twbs.png" alt="" width="32" height="32" class="rounded-circle flex-shrink-0">-->
<!--        <div class="d-flex gap-2 w-100 justify-content-between">-->
<!--            <div><h6 class="mb-0">Another title here</h6>-->
<!--                <p class="mb-0 opacity-75">Some placeholder content in a paragraph that goes a little longer so it wraps-->
<!--                    to a new line.</p></div>-->
<!--            <small class="opacity-50 text-nowrap">3d</small></div>-->
<!--    </a> <a href="#" class="list-group-item list-group-item-action d-flex gap-3 py-3" aria-current="true"> <img-->
<!--            src="https://github.com/twbs.png" alt="" width="32" height="32" class="rounded-circle flex-shrink-0">-->
<!--        <div class="d-flex gap-2 w-100 justify-content-between">-->
<!--            <div><h6 class="mb-0">Third heading</h6>-->
<!--                <p class="mb-0 opacity-75">Some placeholder content in a paragraph.</p></div>-->
<!--            <small class="opacity-50 text-nowrap">1w</small></div>-->
<!--    </a></div>-->
<!--</div>-->

<div class="d-flex flex-shrink-0 bg-body-tertiary vh-100 gap-0" style="width:50%; min-height:0;">
    <div class="list-group list-group-flush border-bottom flex-grow-1 overflow-auto pb-4 pe-2 pt-0">
        {% for object in objects %}
        <a href="{{ url_for('main.object_list', objectid=object.objectid) }}" class="list-group-item list-group-item-action py-3 lh-sm {{'active' if selected_id == object.objectid else ''}}">
            <div class="d-flex w-100 align-items-center justify-content-between">
                <strong class="mb-1">{{object.name}}</strong>
                <small class="text-body-secondary">{{object.address}}</small>
            </div>
            <div class="col-10 mb-1 small">
                {{object.description or "Нет описания"}}
            </div>
        </a>
        {% endfor %}
    </div>

    <div class="divider vertical-rule"></div>

<!--    <div class="list-group list-group-flush border-bottom flex-grow-1 overflow-auto pb-4 pe-2 pt-0">-->
<!--        {% if columns %}-->
<!--            {% for column in columns %}-->
<!--            <div class="list-group-item list-group-item-action py-3 lh-sm">-->
<!--                <div class="d-flex w-100 align-items-center justify-content-between">-->
<!--                    <strong class="mb-1">{{column.name}}</strong>-->
<!--                    <small class="text-body-secondary">{{column.status or "Без статуса"}}</small>-->
<!--                </div>-->
<!--                <div class="col-10 mb-1 small">-->
<!--                    {{ column.finishdate.strftime("%d.%m.%Y") if column.finishdate else "Дата не указана" }}-->
<!--                </div>-->
<!--            </div>-->
<!--            {% endfor %}-->
<!--        {% else %}-->
<!--            <div class="p-3 text-muted">Выберите другой объект, чтобы увидеть колонны</div>-->
<!--        {% endif %}-->
<!--    </div>-->

    <div class="list-group list-group-flush border-bottom overflow-auto pb-4 pe-2 pt-0 flex-fill">
        {% if not selected_id %}
        <div class="p-3 text-muted">Выберите объект слева</div>

        {% elif panel == 'menu' %}
        <!-- Экран выбора раздела -->
        <div class="p-3">
            <div class="fw-semibold mb-3">Что посмотреть по объекту?</div>
            <div class="d-grid gap-2">
                <a class="btn btn-outline-primary"
                   href="{{ url_for('main.object_list', objectid=selected_id, panel='columns') }}">
                    Опоры
                </a>
                <a class="btn btn-outline-primary"
                   href="{{ url_for('main.object_list', objectid=selected_id, panel='trenches') }}">
                    Траншеи
                </a>
                <a class="btn btn-outline-primary"
                   href="{{ url_for('main.object_list', objectid=selected_id, panel='reports') }}">
                    Отчёты
                </a>
            </div>
        </div>

        {% elif panel == 'columns' %}
        <!-- Шапка с кнопкой назад -->
        <div class="sticky-top bg-body p-2 border-bottom d-flex align-items-center justify-content-between">
            <a class="btn btn-link p-0 text-decoration-none"
               href="{{ url_for('main.object_list', objectid=selected_id, panel='menu') }}">← Назад</a>
            <div class="fw-semibold">Опоры</div>
            <div></div>
        </div>

        {% if columns %}
        {% for col in columns %}
        <div class="list-group-item py-3 lh-sm">
            <div class="d-flex w-100 align-items-center justify-content-between">
                <strong class="mb-1">{{ col.name }}</strong>
                <small class="text-body-secondary">{{ col.status or "Без статуса" }}</small>
            </div>
            <div class="col-10 mb-1 small">
                {{ col.finishdate.strftime("%d.%m.%Y") if col.finishdate else "Дата не указана" }}
            </div>
        </div>
        {% endfor %}
        {% else %}
        <div class="p-3 text-muted">Пока нет опор</div>
        {% endif %}

        {% elif panel == 'trenches' %}
        <div class="sticky-top bg-body p-2 border-bottom d-flex align-items-center justify-content-between">
            <a class="btn btn-link p-0 text-decoration-none"
               href="{{ url_for('main.object_list', objectid=selected_id, panel='menu') }}">← Назад</a>
            <div class="fw-semibold">Траншеи</div>
            <div></div>
        </div>

        {% if trenches %}
        {% for tr in trenches %}
        <div class="list-group-item py-3 lh-sm">
            <div class="d-flex w-100 align-items-center justify-content-between">
                <strong class="mb-1">{{ tr.totaltrenchlength }}</strong>
                <small class="text-body-secondary">{{ tr.status or "Без статуса" }}</small>
            </div>
            <div class="col-10 mb-1 small">
                {{ tr.finishdate.strftime("%d.%m.%Y") if tr.finishdate else "Дата не указана" }}
            </div>
        </div>
        {% endfor %}
        {% else %}
        <div class="p-3 text-muted">Пока нет траншей</div>
        {% endif %}

        {% elif panel == 'reports' %}
        <div class="sticky-top bg-body p-2 border-bottom d-flex align-items-center justify-content-between">
            <a class="btn btn-link p-0 text-decoration-none"
               href="{{ url_for('main.object_list', objectid=selected_id, panel='menu') }}">← Назад</a>
            <div class="fw-semibold">Отчёты</div>
            <div></div>
        </div>

        {% if reports %}
        {% for r in reports %}
        <div class="list-group-item py-3 lh-sm">
            <div class="d-flex w-100 align-items-center justify-content-between">
                <strong class="mb-1">{{ r.status }}</strong>
                <small class="text-body-secondary">{{ r.created_at.strftime("%d.%m.%Y") }}</small>
            </div>
            <div class="col-10 mb-1 small">{{ r.comment or "Без описания" }}</div>
        </div>
        {% endfor %}
        {% else %}
        <div class="p-3 text-muted">Отчётов пока нет</div>
        {% endif %}

        {% endif %}
    </div>

</div>


``





{% endblock %}
