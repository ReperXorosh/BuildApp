{% extends "main/mobile_layout_bootstrap.html" %}
{% set active_page = 'objects' %}

{% block title %}{{ element_type }}{% endblock %}
{% block mobile_title %}{{ element_type }}{% endblock %}

{% block content %}
<div class="mobile-card">
    <div class="mobile-card-title">{{ element_type }}</div>
    <div class="mobile-card-text">
        <div class="mb-2"><strong>Объект:</strong> {{ object.name }}</div>
        {% if object.location %}
        <div class="mb-2"><strong>Адрес:</strong> {{ object.location }}</div>
        {% endif %}
    </div>
</div>

<div class="mobile-card">
    <div class="mobile-card-title">Информация</div>
    <div>
        <div class="d-flex justify-content-between mb-2">
            <span class="text-muted">Название</span>
            <span class="fw-semibold">{{ element.zdf_name or element.bracket_name or element.luminaire_name or '—' }}</span>
        </div>
        <div class="d-flex justify-content-between mb-2">
            <span class="text-muted">Статус</span>
            <span class="badge bg-secondary">{{ element.status or '—' }}</span>
        </div>
    {% set _notes_lines = (element.notes or '').split('\n') %}
    {% set _filtered = [] %}
    {% set file_url = None %}
    {% for _l in _notes_lines %}
      {% if 'Файл:' in _l %}
        {% set file_url = _l|replace('Файл:', '')|trim %}
      {% else %}
        {% set _ = _filtered.append(_l) %}
      {% endif %}
    {% endfor %}
    <div class="mt-2">
        <div class="text-muted mb-1">Примечания</div>
        {% set _trimmed = [] %}
        {% for _l in _filtered %}
          {% set _t = _l|trim %}
          {% if _t %}{% set _ = _trimmed.append(_t) %}{% endif %}
        {% endfor %}
        <div>{{ (_trimmed|length > 0) and (_trimmed|join('\n')|replace('\n','<br>')|safe) or '—' }}</div>
    </div>
    {% if file_url %}
    <div class="mt-3">
        <a href="{{ file_url }}" target="_blank" class="btn btn-sm btn-outline-secondary w-100">
            <svg class="bi me-1" width="16" height="16" aria-hidden="true"><use xlink:href="#file-earmark-text"></use></svg>
            Просмотреть файл
        </a>
    </div>
    {% endif %}
    </div>
    <div class="mt-3 d-flex" style="gap:8px;">
        <a href="{{ url_for('objects.elements_list', object_id=object.id) }}" class="btn btn-outline-secondary w-100">К элементам</a>
        <a href="{{ url_for('objects.object_detail', object_id=object.id) }}" class="btn btn-primary w-100">К объекту</a>
    </div>
    <div class="mt-2 small text-muted">ID: {{ element.id }}</div>
    
</div>

<!-- Отступ под нижнюю навигацию -->
<div style="height: 120px"></div>
{% endblock %}


